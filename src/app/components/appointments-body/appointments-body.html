<main class="appointments-page">
  <div class="header-spacer"></div>

  <app-card
    class="patient-card"
    [layout]="'row'"
    [hovereable]="false"
    [bgColor]="'var(--brand-primary-700)'"
    [style.--border-color]="'transparent'"
    [style.overflow]="'hidden'">
    <div card-header class="patient-card__header">
      <div class="patient-card__info">
        <div class="patient-card__name">{{ paciente.nombre }}</div>
        <div class="patient-card__role">Paciente</div>
      </div>
      <div class="patient-card__avatar">{{ iniciales }}</div>
    </div>
  </app-card>

  <div class="cta-wrap">
    <app-button
      text="+ Solicitar Nuevo Turno"
      type="primary"
      width="100%"
      height="56px"
      [bgColor]="'#F26A1B'"
      [txtColor]="'#ffffff'"
      (clicked)="solicitarNuevoTurno()"
    ></app-button>
  </div>

  @for (t of turnos; track t.id) {
    <app-card
      class="appointment-card"
      [layout]="'column'"
      [paddingX]="'4rem'"
      [paddingY]="'4rem'"
      [marginY]="'1rem'"
      [hovereable]="true">
      <div card-header class="appointment-card__head">
        <div class="appointment-card__icon">
          <mat-icon fontSet="material-icons-outlined">calendar_today</mat-icon>
        </div>

        <div class="appointment-card__main">
          <h2 class="appointment-card__title">{{ t.estudio }}</h2>

          <div class="appointment-card__row">
            <mat-icon class="appointment-card__row-icon" fontSet="material-icons-outlined">schedule</mat-icon>
            <span>{{ t.fecha }} a las {{ t.hora }}</span>
          </div>
          <div class="appointment-card__row">
            <span class="appointment-card__emoji">👨‍⚕️</span>
            <span>{{ t.doctor }}</span>
          </div>
          <div class="appointment-card__row">
            <span class="appointment-card__emoji">📍</span>
            <span>{{ t.sede }}</span>
          </div>
        </div>

        <app-button
          class="appointment-card__status"
          [text]="t.estado"
          type="secondary"
          width="auto"
          height="40px"
          [bgColor]="'#c1d6b6'"
          [txtColor]="'rgba(42,104,27,0.68)'"
          [yPad]="'0.25'"
          [xPad]="'0.75'">
        </app-button>
      </div>

      <div card-actions class="appointment-card__actions">
        @if (t.advertencias?.length) {
          <div class="expander-wrap">
            <app-expansion-panel title="Preparación" [badge]="t.advertencias?.length">
              @if (t.advertencias) {
                <app-warning-item [warnings]="t.advertencias"></app-warning-item>
              }
            </app-expansion-panel>
          </div>
        }

        <div class="modify-wrap">
          <app-button
            text="Modificar Turno"
            type="secondary"
            width="100%"
            height="48px"
            [bgColor]="'#f1ebeb'"
            [txtColor]="'rgba(0,0,0,0.47)'"
            [yPad]="'1'"
            [xPad]="'1'"
            (clicked)="modificarTurno(t.id)">
          </app-button>
        </div>
      </div>
    </app-card>
  }
</main>

<button aria-label="Ir al inicio" (click)="redirect('/home')" class="home-fab">
  <mat-icon>home</mat-icon>
</button>
